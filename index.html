<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>NeroBank</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body { margin:0; font-family:Arial; background:#eef2f5; transition:0.3s; }
.dark { background:#121212; color:white; }
.app { max-width:420px; margin:auto; background:white; min-height:100vh; box-shadow:0 0 10px rgba(0,0,0,0.1); transition:0.3s; }
.dark .app { background:#1e1e1e; }
header { background:#0a4b78; color:white; padding:15px; text-align:center; }
.logo { font-weight:bold; font-size:20px; }
section { padding:15px; }
.card { background:linear-gradient(135deg,#0a4b78,#0f6fa8); color:white; padding:20px; border-radius:12px; margin-bottom:15px; }
button { padding:10px; width:100%; border:none; border-radius:6px; margin-top:8px; background:#0a4b78; color:white; }
input { padding:10px; width:100%; margin-top:5px; }
.notification { background:#dff0d8; padding:10px; border-radius:6px; margin-bottom:10px; display:none; }
.profile-pic { width:70px; height:70px; border-radius:50%; object-fit:cover; margin-bottom:10px; }
.toggle { background:#444; margin-top:10px; }
</style>
</head>
<body>

<div class="app">

<header>
<div class="logo">üè¶ NeroBank</div>
<button class="toggle" onclick="toggleTheme()">üåô Mode sombre</button>
</header>

<section id="auth">
<h3>Connexion</h3>
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Mot de passe">
<button onclick="register()">Cr√©er compte</button>
<button onclick="login()">Connexion</button>
<button onclick="adminLogin()">Admin</button>
</section>

<section id="dashboard" style="display:none;">
<div class="notification" id="notif"></div>

<img id="profilePic" class="profile-pic" src="https://via.placeholder.com/70">
<input type="file" onchange="uploadPic(event)">

<div class="card">
üí≥ **** 4587<br><small>Valid 12/29</small>
</div>

<p><b>Solde :</b> <span id="balance"></span></p>
<p><b>IBAN :</b> <span id="iban"></span></p>
<p><b>KYC :</b> <span id="kycStatus"></span></p>

<button onclick="sendKYC()">Soumettre KYC</button>

<h3>Virement</h3>
<input id="recipient" placeholder="IBAN destinataire">
<input id="amount" type="number" placeholder="Montant ‚Ç¨">
<button onclick="transfer()">Envoyer</button>

<h3>D√©penses</h3>
<canvas id="chart"></canvas>

<button onclick="downloadPDF()">Relev√© PDF</button>
<button onclick="logout()">D√©connexion</button>
</section>

<section id="adminPanel" style="display:none;">
<h3>Admin Panel</h3>
<ul id="usersList"></ul>
<button onclick="logout()">D√©connexion</button>
</section>

</div>

<script>
const firebaseConfig={apiKey:"TON_API_KEY",authDomain:"TON_AUTH_DOMAIN",projectId:"TON_PROJECT_ID"};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth(); const db=firebase.firestore();

function notify(msg){ notif.innerText=msg; notif.style.display="block"; setTimeout(()=>notif.style.display="none",3000); }

function toggleTheme(){ document.body.classList.toggle("dark"); }

function register(){
auth.createUserWithEmailAndPassword(email.value,password.value).then(u=>{
db.collection("users").doc(u.user.uid).set({email:email.value,balance:1000,iban:"DE"+Math.floor(Math.random()*1000000000),kyc:"Pending"});
notify("Compte cr√©√© avec succ√®s");
});
}

function login(){auth.signInWithEmailAndPassword(email.value,password.value).then(()=>loadDash());}

function loadDash(){
let u=auth.currentUser;
db.collection("users").doc(u.uid).get().then(doc=>{
let d=doc.data();
auth.style.display="none"; dashboard.style.display="block";
balance.innerText=d.balance+"‚Ç¨"; iban.innerText=d.iban; kycStatus.innerText=d.kyc;
loadChart();
notify("Bienvenue sur NeroBank");
});
}

function transfer(){
db.collection("transactions").add({user:auth.currentUser.uid,amount:parseFloat(amount.value),date:new Date().toLocaleDateString()});
notify("Virement simul√© envoy√©");
loadChart();
}

function loadChart(){
db.collection("transactions").where("user","==",auth.currentUser.uid).get().then(q=>{
let data=[]; q.forEach(doc=>data.push(doc.data().amount));
new Chart(document.getElementById('chart'),{type:'bar',data:{labels:data.map((_,i)=>"Tx"+(i+1)),datasets:[{label:"D√©penses",data:data}]}});
});
}

function sendKYC(){db.collection("users").doc(auth.currentUser.uid).update({kyc:"Under Review"});kycStatus.innerText="Under Review";notify("Documents KYC envoy√©s");}

function uploadPic(e){
let reader=new FileReader();
reader.onload=()=>profilePic.src=reader.result;
reader.readAsDataURL(e.target.files[0]);
}

function adminLogin(){if(email.value==="admin@nerobank.com"&&password.value==="admin123"){auth.style.display="none";adminPanel.style.display="block";loadUsers();}}
function loadUsers(){usersList.innerHTML="";db.collection("users").get().then(q=>{q.forEach(doc=>{let d=doc.data();let li=document.createElement("li");li.innerHTML=`${d.email} - ${d.kyc} <button onclick="approve('${doc.id}')">Valider</button>`;usersList.appendChild(li);});});}
function approve(id){db.collection("users").doc(id).update({kyc:"Approved"});notify("KYC valid√©");loadUsers();}
function downloadPDF(){const{jsPDF}=window.jspdf;let doc=new jsPDF();doc.text("NeroBank Statement DEMO",20,20);doc.text("Email: "+auth.currentUser.email,20,30);doc.text("Solde: "+balance.innerText,20,40);doc.save("statement.pdf");}
function logout(){auth.signOut();location.reload();}
</script>
</body>
</html>
